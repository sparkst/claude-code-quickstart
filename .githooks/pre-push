#!/usr/bin/env bash
# REQ-110 â€” Pre-push validation hook
# This hook runs before pushing to ensure comprehensive validation

set -e

echo "ğŸš€ Running pre-push validations..."

# Full test suite
echo "ğŸ§ª Running full test suite..."
if ! npm run test:run; then
  echo "âŒ Tests failed. Fix issues before pushing."
  exit 1
fi
echo "âœ… Full test suite passed"

# Linting and formatting
echo "ğŸ” Final linting check..."
if ! npm run lint; then
  echo "âŒ Linting issues found."
  exit 1
fi

echo "ğŸ“ Final formatting check..."
if ! npm run format:check; then
  echo "âŒ Formatting issues found."
  exit 1
fi

# Security scan
echo "ğŸ” Security validation..."
if command -v npm audit >/dev/null 2>&1; then
  npm audit --audit-level=moderate --production || echo "âš ï¸ Security audit completed with warnings"
fi

echo "âœ… Pre-push validation completed successfully"
echo "ğŸš€ Ready to push!"